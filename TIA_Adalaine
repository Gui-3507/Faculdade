clc
clear all

x = [-1,0.4329,-1.3719,0.7022,-0.8535,1.0000;
-1,0.3024,0.2286,0.8630,2.7909,-1.0000;
-1,0.1349,-0.6445,1.0530,0.5687,-1.0000;
-1,0.3374,-1.7163,0.3670,-0.6283,-1.0000;
-1,1.1434,-0.0485,0.6637,1.2606,1.0000;
-1,1.3749,-0.5071,0.4464,1.3009,1.0000;
-1,0.7221,-0.7587,0.7681,-0.5592,1.0000;
-1,0.4403,-0.8072,0.5154,-0.3129,1.0000;
-1,-0.5231,0.3548,0.2538,1.5776,-1.0000;
-1,0.3255,-2.0000,0.7112,-1.1209,1.0000;
-1,0.5824,1.3915,-0.2291,4.1735,-1.0000;
-1,0.1340,0.6081,0.4450,3.2230,-1.0000;
-1,0.1480,-0.2988,0.4778,0.8649,1.0000;
-1,0.7359,0.1869,-0.0872,2.3584,1.0000;
-1,0.7115,-1.1469,0.3394,0.9573,-1.0000;
-1,0.8251,-1.2840,0.8452,1.2382,-1.0000;
-1,0.1569,0.3712,0.8825,1.7633,1.0000;
-1,0.0033,0.6835,0.5389,2.8249,-1.0000;
-1,0.4243,0.8313,0.2634,3.5855,-1.0000;
-1,1.0490,0.1326,0.9138,1.9792,1.0000;
-1,1.4276,0.5331,-0.0145,3.7286,1.0000;
-1,0.5971,1.4865,0.2904,4.6069,-1.0000;
-1,0.8475,2.1479,0.3179,5.8235,-1.0000;
-1,1.3967,-0.4171,0.6443,1.3927,1.0000;
-1,0.0044,1.5378,0.6099,4.7755,-1.0000;
-1,0.2201,-0.5668,0.0515,0.7829,1.0000;
-1,0.6300,-1.2480,0.8591,0.8093,-1.0000;

-1,-0.2479,0.8960,0.0547,1.7381,1.0000;
-1,-0.3088,-0.0929,0.8659,1.5483,-1.0000;
-1,-0.5180,1.4974,0.5453,2.3993,1.0000;
-1,0.6833,0.8266,0.0829,2.8864,1.0000;
-1,0.4353,-1.4066,0.4207,-0.4879,1.0000;
-1,-0.1069,-3.2329,0.1856,-2.4572,-1.0000;
-1,0.4662,0.6261,0.7304,3.4370,-1.0000;
-1,0.8298,-1.4089,0.3119,1.3235,-1.0000];

xt = [-1,0.9694,0.6909,0.4334,3.4965;
-1,0.5427,1.3832,0.6390,4.0352;
-1,0.6081,-0.9196,0.5925,0.1016;
-1,-0.1618,0.4694,0.2030,3.0117;
-1,0.1870,-0.2578,0.6124,1.7749;
-1,0.4891,-0.5276,0.4378,0.6439;
-1,0.3777,2.0149,0.7423,3.3932;
-1,1.1498,-0.4067,0.2469,2.5866;
-1,0.9325,1.0950,1.0359,3.3591;
-1,0.5060,1.3317,0.9222,3.7174;
-1,0.0497,-2.0656,0.6124,-0.6585;
-1,0.4004,3.5369,0.9766,5.3532;
-1,-0.1874,1.3343,0.5374,3.2189;
-1,0.5060,1.3317,0.9222,3.7174;
-1,1.6375,-0.7911,0.7537,0.5515];

w = [rand() rand() rand() rand() rand()];
EqmVet=[];
l = 1;

disp('Pesos iniciais:');
w'
disp('-----------------------');

disp('Taxa de aprendizado:');
n = 0.0025
disp('');
disp('Precisão:');
e = 10^-6
disp('');
disp('Número de épocas:');
epocas = 0
disp('');
disp('-----------------------');

E = 1;
Eqm = 0;

while E > e
Eqma = Eqm;
for i=1:35
u = sum(x(i,1:5).*w);
EqmVet(l) = Eqm;
l = l+1;
Eqm = Eqm + (x(i,6)-u)^2;
for z=1:5
w(z) = w(z) + n*(x(i,6)-u)*x(i,z);
endfor
endfor
epocas = epocas + 1;
Eqm = Eqm/35;
Eqmat = Eqm;
E = abs(Eqma - Eqmat);

endwhile

disp('Número de epocas:');

epocas
disp('Pesos finais:');
w'
disp('-----------------------');
plot(EqmVet);

for p=1:15
u = sum(xt(p,:).*w);
if u >=0
disp('B')
else
disp('A')
endif
endfor
